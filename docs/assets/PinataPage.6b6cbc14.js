import{Q as pe}from"./QPage.bb062400.js";import{d as he,r,I,c as xe,o as me,a as ye,p,A as ge,B as we,u as s,q as y,O as q,F as te,N as ae,v as oe,S as W,U as ne,V as Me,W as _e}from"./index.f98f6e62.js";import{_ as ke}from"./plugin-vue_export-helper.21dcd24c.js";import"./render.3e5ae0ee.js";const Fe={key:0,src:"/images/pinata3.png",alt:"p\xE9gale"},De={key:1,class:"crack-effect"},Se={key:2,class:"pinata-parts"},Ce={key:3,class:"confetti-container"},$e={class:"dev-controls"},Te={class:"dev-counter"},j=.1,Q=.95,U=30,Be=he({__name:"PinataPage",setup(Pe){const g=r(null),A=r(null),E=r(null),w=r(!1),b=I({x:0,y:0}),f=I({x:0,y:0}),H=r(0),i=I({x:0,y:0,rotation:0}),F=r([]),o=I({x:0,y:0,rotation:0}),D=r(0),d=r(!1),v=r(!1),S=r(!1),C=r(!1),$=r(""),T=r(""),X=r(0),B=r(0),P=r(0),z=r(0);function Y(){D.value=0,d.value=!1,v.value=!1,C.value=!1,S.value=!1,F.value=[],i.x=0,i.y=0,i.rotation=0,o.x=0,o.y=0,o.rotation=0,g.value&&(g.value.style.transform="translate(0px, 0px) rotate(0deg)"),console.log("Juego reiniciado")}const ie=xe(()=>t=>({left:`${t.x}px`,top:`${t.y}px`,transform:`rotate(${t.angle}deg)`,opacity:t.opacity,width:`${t.length}px`}));function se(t){const e=t*12%360,a=t%10*.1,n=Math.floor(Math.random()*10)+5,l=Math.floor(Math.random()*100),u=Math.floor(Math.random()*3)+2;return{backgroundColor:`hsl(${e}, 90%, 65%)`,animationDelay:`${a}s`,width:`${n}px`,height:`${n}px`,left:`${l}%`,animationDuration:`${u}s`}}function J(t){if(d.value||v.value)return;w.value=!0;const e=K(t);e&&(b.x=e.x,b.y=e.y,f.x=e.x,f.y=e.y,H.value=Date.now()),C.value=!1,X.value=Date.now(),B.value=0,P.value=0,z.value=0,F.value=[]}function O(t){if(!w.value||d.value||v.value)return;const e=K(t);if(!e)return;const a=Date.now(),n=Math.max(1,a-H.value),l=e.x-f.x,u=e.y-f.y,c=l/n,M=u/n,h=Math.sqrt(c*c+M*M);P.value=Math.max(P.value,h);const x=Math.sqrt(l*l+u*u);if(x>10){B.value+=x;const V=e.x-b.x,R=e.y-b.y;z.value=Math.sqrt(V*V+R*R),de(f.x,f.y,e.x,e.y);const m=ue(),_=ce(m.x,m.y,f.x,f.y,e.x,e.y);if(_<150&&!C.value&&(C.value=!0,ve(),S.value=!0,setTimeout(()=>{S.value=!1},1e3)),_<150){const k=Math.min(.3,Math.max(.05,h*10));o.x+=l*k,o.y+=u*k;const L=Math.min(.03,Math.max(.01,h*5));o.rotation+=(l>0?1:-1)*x*L}f.x=e.x,f.y=e.y,H.value=a}}function N(){if(!w.value||d.value||v.value){w.value=!1;return}if(C.value){const t=(Date.now()-X.value)/1e3;if(console.log({swipeDistance:B.value.toFixed(2),swipeDirectDistance:z.value.toFixed(2),swipeMaxSpeed:P.value.toFixed(4),swipeDuration:t.toFixed(2)}),t>0&&B.value>0){const e=Math.min(1.5,Math.max(.5,B.value/500)),a=Math.min(1.5,Math.max(.5,P.value*5)),n=Math.min(1.5,Math.max(.5,1/(t*2))),l=e*.6+a*.3+n*.1,u=.5+(l-.5)*(2.5/1.5),c=parseFloat(u.toFixed(1));console.log(`Factores: Distancia=${e.toFixed(2)}, Velocidad=${a.toFixed(2)}, Duraci\xF3n=${n.toFixed(2)}`),console.log(`Valor del golpe: ${c}`),D.value+=c,c<=1?($.value="\xA1Suave!",T.value="hit-low"):c<=2?($.value="\xA1Bueno!",T.value="hit-mid"):($.value="\xA1INCRE\xCDBLE!",T.value="hit-strong"),console.log(`Golpe con intensidad: ${c}, contador: ${D.value.toFixed(1)} de ${U}`),D.value>=U&&!d.value&&le()}else D.value+=.5,$.value="\xA1Flojo!",T.value="hit-very-low"}w.value=!1,F.value=[]}function le(){console.log("\xA1Iniciando animaci\xF3n de ruptura!"),fe(),w.value=!1,d.value=!0,F.value=[],S.value=!0,(()=>{o.x=0,o.y=0,o.rotation=0;const e=setInterval(()=>{i.x*=.9,i.y*=.9,i.rotation*=.9,Math.abs(i.x)<1&&Math.abs(i.y)<1&&Math.abs(i.rotation)<1&&(clearInterval(e),setTimeout(()=>{S.value=!1,re()},300))},16)})()}function re(){console.log("Completando ruptura"),d.value=!0,setTimeout(()=>{v.value=!0,o.y=-20,o.rotation=Math.random()>.5?40:-40},300)}function ue(){var a;if(!g.value)return{x:window.innerWidth/2,y:window.innerHeight/2};const t=g.value.getBoundingClientRect(),e=(a=document.querySelector(".pinata-container"))==null?void 0:a.getBoundingClientRect();return e?{x:t.left+t.width/2-e.left,y:t.top+t.height/2-e.top}:{x:window.innerWidth/2,y:window.innerHeight/2}}function ce(t,e,a,n,l,u){const c=t-a,M=e-n,h=l-a,x=u-n,V=c*h+M*x,R=h*h+x*x;let m=-1;R!==0&&(m=V/R);let _,k;m<0?(_=a,k=n):m>1?(_=l,k=u):(_=a+m*h,k=n+m*x);const L=t-_,ee=e-k;return Math.sqrt(L*L+ee*ee)}function de(t,e,a,n){const l=(t+a)/2,u=(e+n)/2,c=Math.atan2(n-e,a-t)*(180/Math.PI),M=Math.sqrt(Math.pow(a-t,2)+Math.pow(n-e,2));F.value.push({x:l-M/2,y:u,angle:c,opacity:1,length:M})}function K(t){var l;let e,a;if(window.TouchEvent&&t instanceof TouchEvent){if(t.touches.length===0)return null;e=t.touches[0].clientX,a=t.touches[0].clientY}else if(t instanceof MouseEvent)e=t.clientX,a=t.clientY;else return null;const n=(l=document.querySelector(".pinata-container"))==null?void 0:l.getBoundingClientRect();return n?{x:e-n.left,y:a-n.top}:null}let G;function Z(){v.value?(o.y+=.5,i.y+=o.y,i.rotation+=o.rotation*.5,i.y>500&&(o.y=0,o.rotation=0)):(o.x*=Q,o.y*=Q,o.rotation*=Q,o.x-=i.x*j,o.y-=i.y*j,o.rotation-=i.rotation*j,i.x+=o.x,i.y+=o.y,i.rotation+=o.rotation),g.value&&(g.value.style.transform=`translate(${i.x}px, ${i.y}px) rotate(${i.rotation}deg)`),G=requestAnimationFrame(Z)}me(()=>{G=requestAnimationFrame(Z),Y()}),ye(()=>{cancelAnimationFrame(G)});function ve(){A.value&&(A.value.currentTime=1,A.value.play().catch(t=>console.error("Error reproduciendo sonido:",t)))}function fe(){E.value&&(E.value.currentTime=0,E.value.play().catch(t=>console.error("Error reproduciendo sonido de ruptura:",t)))}return(t,e)=>(p(),ge(pe,{class:"flex flex-center pinata-container"},{default:we(()=>[e[2]||(e[2]=s("div",{class:"clouds-container"},[s("div",{class:"cloud cloud1"}),s("div",{class:"cloud cloud2"}),s("div",{class:"cloud cloud3"}),s("div",{class:"cloud cloud4"}),s("div",{class:"cloud cloud5"})],-1)),s("audio",{ref_key:"hitSoundRef",ref:A,src:"/sounds/woop.mp3",preload:"auto"},null,512),s("audio",{ref_key:"breakSoundRef",ref:E,src:"/sounds/game-over.mp3",preload:"auto"},null,512),s("div",{class:"hit-detector",onMousedown:J,onTouchstart:J,onMousemove:O,onTouchmove:O,onMouseup:N,onTouchend:N,onMouseleave:N},null,32),s("div",{ref_key:"pinataRef",ref:g,class:oe(["pinata",{breaking:d.value,broken:v.value}])},[!d.value&&!v.value?(p(),y("img",Fe)):q("",!0),d.value&&!v.value?(p(),y("div",De,e[0]||(e[0]=[s("svg",{viewBox:"0 0 100 200",xmlns:"http://www.w3.org/2000/svg"},[s("path",{d:"M50,0 L45,40 L55,70 L42,100 L58,130 L48,160 L50,200",stroke:"white","stroke-width":"3",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]))):q("",!0),d.value||v.value?(p(),y("div",Se,e[1]||(e[1]=[s("div",{class:"pinata-half left"},[s("img",{src:"/images/pinata3.png",alt:"mitad izquierda"})],-1),s("div",{class:"pinata-half right"},[s("img",{src:"/images/pinata3.png",alt:"mitad derecha"})],-1)]))):q("",!0),v.value?(p(),y("div",Ce,[(p(),y(te,null,ae(30,a=>s("div",{key:a,class:"confetti",style:ne(se(a))},null,4)),64))])):q("",!0)],2),(p(!0),y(te,null,ae(F.value,(a,n)=>Me((p(),y("div",{key:n,class:"slash",style:ne(ie.value(a))},null,4)),[[_e,w.value]])),128)),S.value?(p(),y("div",{key:0,class:oe(["hit-counter",T.value])},W($.value),3)):q("",!0),s("div",$e,[s("div",Te," Golpes: "+W(parseFloat(D.value.toFixed(1)))+" / "+W(U),1),s("button",{class:"reset-button",onClick:Y},"Reiniciar")])]),_:1}))}});var be=ke(Be,[["__scopeId","data-v-e30ce528"]]);export{be as default};
